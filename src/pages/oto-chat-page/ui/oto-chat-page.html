<app-chat-layout
  [selectedChat]="displayChatName"
  [selectedChatImage]="displayChatImage"
>
  <app-oto-chat-list
    chat-sidebar
    [accessToken]="accessToken || ''"
    [currentUserNickName]="currentUserNickName"
    [selectedNickname]="selectedOtoChat?.nickName"
    (chatSelected)="onOtoChatSelected($event)"
    (foundedUser)="onFoundedUser($event)"
    (userInfoUpdated)="onUserInfoUpdated($event)"
    (selectedChatUserUpdated)="onSelectedChatUserUpdated($event)"
    (userDeleted)="onUserDeleted($event)"
    (chatClosedDueToUserDeletion)="onChatClosedDueToUserDeletion()"
  ></app-oto-chat-list>

  <ng-container chat-content>
    <ng-container *ngIf="selectedOtoChat; else noChatSelected">
      <div class="flex flex-col h-full">
        <div class="flex-1 overflow-hidden">
          <app-oto-chat-messages 
            #messagesComponent
            [chatNickName]="selectedOtoChat.nickName" 
            [currentUserNickName]="currentUserNickName"
            (editMessage)="onEditMessage($event)"
            (deleteMessage)="onDeleteMessage($event)"
            (replyToMessage)="onReplyToMessage($event)"
            (chatUserDeleted)="onChatUserDeletedFromMessages()">
          </app-oto-chat-messages>
        </div>
        
        <shared-send-message-area
          [editingMessage]="editingMessage"
          [replyingToMessage]="replyingToMessage"
          (send)="onSendMessage($event)"
          (editComplete)="onEditComplete($event)"
          (editCancel)="onEditCancel()"
          (replyCancel)="onCancelReply()"
        ></shared-send-message-area>
      </div>
    </ng-container>
    
    <ng-template #noChatSelected>
    </ng-template>
  </ng-container>
</app-chat-layout>